/**
 * \class WaveGen
 *
 *
 * \brief Generates a wave-sample of given frequency.
 *
 * This class can be used as an oscillator for sine, square, triangle, 
 * sawtooth and a custom waveform. 
 * It generates wave samples for a given frequency and provides anti-aliasing
 * for square and sawtooth wave.
 *
 *
 * \author $Author: Corvin Jaedicke & Alberto Monciero $
 *
 * \version $Revision: 1.5 $
 *
 * \date $Date: 2017/29/04 17:55:00 $
 *
 * Contact: c.jaedicke@math.tu-berlin.de
 *
 */

#pragma once

#define _USE_MATH_DEFINES

#include <iostream>
#include <stdlib.h>
#include <unistd.h>
#include <vector>
#include <math.h>

using std::cout;
using std::endl;

/// Wave-types that can be generated with this class (SINUS, SQUARE, TRIANGLE, SAWTOOTH, CUSTOM_WAVE).
enum TYPE
{
    SINUS,
    SQUARE,
    TRIANGLE,
    SAWTOOTH,
    CUSTOM_WAVE
};

class WaveGen
{
public:
    /// Create a WaveGen object with default values with a sine at 440 Hz and 48kHz fs.
    WaveGen() : 
    freq(440.0),
    amp(1.0),
    phi(0.0),
    phiIncrement(0.0),
    fs(48000),
    _type(SINUS) { 
    	updatePhi(); 
    };

    /** 
     * Create a WaveGen with initially set properties.
     * \param f Frequency
     * \param a Amplitude
     * \param p Phase
     * \param fS Sampling-Rate
     * \param type Wave type
     */
    WaveGen(float f, float a, float p, int fS, TYPE type);

    /// Get current frequency.
    float getFrequency();
    /// Get current amplitude.
    float getAmplitude();
    /// Get current phase of the wave.
    float getPhase();
    /// Set new frequency and update phase increment.
    void setFrequency(float f);
    /// Set new amplitude.
    void setAmplitude(float a);
    /// Set new phase.
    void setPhase(float p);
    /// Set new wave type (SINUS, SQUARE, TRIANGLE, SAWTOOTH, CUSTOM_WAVE).
    void setType(TYPE type);
    /// Reset WaveGen object to 0Hz and phase = 0.
    void reset();

    /**
     * \brief Gets the next sample but without any anti-aliasing.
     * \return Sample to the current phase.
     *
     * This method gets the next sample but without any anti-aliasing applied.
     * The amplitude is applied and the phase of the
     * wave is increased, according to the sample rate and frequency.
     *
     */
    float getNextSample();

    /**
     * \brief Gets the next sample with anti-aliasing applied.
     * \return Sample to the current phase.
     *
     * This method gets the next sample with anti-aliasing applied.
     * The amplitude is applied and the phase of the
     * wave is increased, according to the sample rate and frequency.
     *
     */
    float getNextAntiAliasedSample();

    /**
     * \brief Gets the next sample with anti-aliasing applied.
     *
     * This method gets the next sample with anti-aliasing applied.
     * The amplitude is applied and the phase of the
     * wave is increased, according to the sample rate and frequency.
   	 * Implements call-by-reference for faster handling of samples.
     *
     */
    void getNextAntiAliasedSample(float * pSample);
    



protected:

    // OSCILLATOR STATE
    float freq; ///< Frequency
    float amp; ///< Amplitude
    float phi; ///< Phase
    float phiIncrement; ///< Phase-increment
    int fs; ///< Sampling-frequency
    TYPE _type; ///< Wave type (SINUS, SQUARE, TRIANGLE, SAWTOOTH, CUSTOM_WAVE)
    const float TWO_PI = 2.0*M_PI;
    static const int lookUpTableSize = 512; ///< Size of look-up tables
   	const float factorLUT = (float) lookUpTableSize / TWO_PI; ///< LUT-increment

   	bool isFreqZero = false; ///< Flag if frequency is zero (true) else (false), default (false)
   	/**
   	 * \brief Updates the phase increment value.
   	 *
   	 * Is called every time the Frequency or Sampling-Rate changes.
   	 */
    void updatePhi();

    /**
   	 * \brief Calculates sample of a wave.
   	 * \param type Specifies of which wave-type the sample should be.
   	 * \param pSample Pointer to the sample which should be calculated.
   	 *
   	 * Samples are calculated through simple math functions,
   	 * except for the custom wave which is taken from a LUT.
   	 * This function has proven to be faster than using LUT only.
   	 */
    void aliasedWaveGen(TYPE type, float * pSample);

    /**
   	 * \brief Calculates sample of a wave.
   	 * \param type Specifies of which wave-type the sample should be.
   	 * \param pSample Pointer to the sample which should be calculated.
   	 *
   	 * Samples are calculated through LUT.
   	 */
    void aliasedWaveGenLUT(TYPE type, float * pSample);
    /**
   	 * \brief Get a custom-wave sample from the LUT.
   	 * \param pPhi Pointer to the current phase.
   	 * \return Interpolated sample.
   	 *
   	 * Samples are taken from LUT and linearly interpolated to the current phase position.
   	 */
    float lookUpCustomWave(float * pPhi);
    /**
   	 * \brief Get a sawtooth-wave sample from the LUT.
   	 * \param pPhi Pointer to the current phase.
   	 * \return Interpolated sample.
   	 *
   	 * Samples are taken from LUT and linearly interpolated to the current phase position.
   	 */
    float lookUpSawtooth(float * pPhi);
    /**
   	 * \brief Get a triangle-wave sample from the LUT.
   	 * \param pPhi Pointer to the current phase.
   	 * \return Interpolated sample.
   	 *
   	 * Samples are taken from LUT and linearly interpolated to the current phase position.
   	 */
    float lookUpTriangle(float * pPhi);
    /**
   	 * \brief Get a sine-wave sample from the LUT.
   	 * \param pPhi Pointer to the current phase.
   	 * \return Interpolated sample.
   	 *
   	 * Samples are taken from LUT and linearly interpolated to the current phase position.
   	 */
    float lookUpSine(float * pPhi);
    /**
 	 * \brief Polynomial Bandlimited Step (BLEP)
 	 * \param t The current phase divided by two pi
 	 * \return Amount of correction which has to be applied to a sample.
 	 *
 	 * This fuction calculates the correction-coefficient used to correct the non-bandlimited waveform at its transients.
 	 * This is done by calculating a trivial polynomial for two samples per transient.
 	 * Because polynomial BLEP's are quasi-bandlimited there will be audible aliasing when approaching Nyquist frequency. Still much better than without!
 	 * Taken from http://www.kvraudio.com/forum/viewtopic.php?t=375517 by Tale with some modifications.
 	 */
    float polyBlep(float t);
    const float sine[lookUpTableSize+1] = {0.0,0.0122715382857199,0.0245412285229123,0.0368072229413588,0.0490676743274180,0.0613207363022086,0.0735645635996674,0.0857973123444399,0.0980171403295606,0.110222207293883,0.122410675199216,0.134580708507126,0.146730474455362,0.158858143333861,0.170961888760301,0.183039887955141,0.195090322016128,0.207111376192219,0.219101240156870,0.231058108280671,0.242980179903264,0.254865659604515,0.266712757474898,0.278519689385053,0.290284677254462,0.302005949319228,0.313681740398892,0.325310292162263,0.336889853392220,0.348418680249435,0.359895036534988,0.371317193951838,0.382683432365090,0.393992040061048,0.405241314004990,0.416429560097637,0.427555093430282,0.438616238538528,0.449611329654607,0.460538710958240,0.471396736825998,0.482183772079123,0.492898192229784,0.503538383725718,0.514102744193222,0.524589682678469,0.534997619887097,0.545324988422047,0.555570233019602,0.565731810783613,0.575808191417845,0.585797857456439,0.595699304492433,0.605511041404326,0.615231590580627,0.624859488142386,0.634393284163646,0.643831542889791,0.653172842953777,0.662415777590172,0.671558954847018,0.680600997795453,0.689540544737067,0.698376249408973,0.707106781186548,0.715730825283819,0.724247082951467,0.732654271672413,0.740951125354959,0.749136394523459,0.757208846506485,0.765167265622459,0.773010453362737,0.780737228572094,0.788346427626606,0.795836904608884,0.803207531480645,0.810457198252595,0.817584813151584,0.824589302785025,0.831469612302545,0.838224705554838,0.844853565249707,0.851355193105265,0.857728610000272,0.863972856121587,0.870086991108711,0.876070094195407,0.881921264348355,0.887639620402854,0.893224301195515,0.898674465693954,0.903989293123443,0.909167983090522,0.914209755703531,0.919113851690058,0.923879532511287,0.928506080473216,0.932992798834739,0.937339011912575,0.941544065183021,0.945607325380521,0.949528180593037,0.953306040354194,0.956940335732209,0.960430519415566,0.963776065795440,0.966976471044852,0.970031253194544,0.972939952205560,0.975702130038529,0.978317370719628,0.980785280403230,0.983105487431216,0.985277642388941,0.987301418157858,0.989176509964781,0.990902635427780,0.992479534598710,0.993906970002356,0.995184726672197,0.996312612182778,0.997290456678690,0.998118112900149,0.998795456205172,0.999322384588350,0.999698818696204,0.999924701839145,1,0.999924701839145,0.999698818696204,0.999322384588350,0.998795456205172,0.998118112900149,0.997290456678690,0.996312612182778,0.995184726672197,0.993906970002356,0.992479534598710,0.990902635427780,0.989176509964781,0.987301418157858,0.985277642388941,0.983105487431216,0.980785280403230,0.978317370719628,0.975702130038529,0.972939952205560,0.970031253194544,0.966976471044852,0.963776065795440,0.960430519415566,0.956940335732209,0.953306040354194,0.949528180593037,0.945607325380521,0.941544065183021,0.937339011912575,0.932992798834739,0.928506080473216,0.923879532511287,0.919113851690058,0.914209755703531,0.909167983090523,0.903989293123443,0.898674465693954,0.893224301195515,0.887639620402854,0.881921264348355,0.876070094195407,0.870086991108712,0.863972856121587,0.857728610000272,0.851355193105265,0.844853565249707,0.838224705554838,0.831469612302545,0.824589302785025,0.817584813151584,0.810457198252595,0.803207531480645,0.795836904608884,0.788346427626606,0.780737228572095,0.773010453362737,0.765167265622459,0.757208846506485,0.749136394523459,0.740951125354959,0.732654271672413,0.724247082951467,0.715730825283819,0.707106781186548,0.698376249408973,0.689540544737067,0.680600997795453,0.671558954847019,0.662415777590172,0.653172842953777,0.643831542889791,0.634393284163646,0.624859488142386,0.615231590580627,0.605511041404326,0.595699304492434,0.585797857456439,0.575808191417845,0.565731810783614,0.555570233019602,0.545324988422046,0.534997619887097,0.524589682678469,0.514102744193222,0.503538383725718,0.492898192229784,0.482183772079123,0.471396736825998,0.460538710958240,0.449611329654607,0.438616238538528,0.427555093430282,0.416429560097637,0.405241314004990,0.393992040061048,0.382683432365090,0.371317193951838,0.359895036534988,0.348418680249435,0.336889853392220,0.325310292162263,0.313681740398891,0.302005949319228,0.290284677254462,0.278519689385053,0.266712757474899,0.254865659604515,0.242980179903264,0.231058108280671,0.219101240156870,0.207111376192219,0.195090322016129,0.183039887955141,0.170961888760301,0.158858143333861,0.146730474455362,0.134580708507126,0.122410675199216,0.110222207293883,0.0980171403295608,0.0857973123444402,0.0735645635996677,0.0613207363022085,0.0490676743274180,0.0368072229413588,0.0245412285229123,0.0122715382857200,0.0,-0.0122715382857198,-0.0245412285229121,-0.0368072229413586,-0.0490676743274177,-0.0613207363022082,-0.0735645635996675,-0.0857973123444399,-0.0980171403295606,-0.110222207293883,-0.122410675199216,-0.134580708507126,-0.146730474455362,-0.158858143333861,-0.170961888760301,-0.183039887955141,-0.195090322016128,-0.207111376192219,-0.219101240156870,-0.231058108280671,-0.242980179903264,-0.254865659604514,-0.266712757474898,-0.278519689385053,-0.290284677254462,-0.302005949319228,-0.313681740398891,-0.325310292162263,-0.336889853392220,-0.348418680249435,-0.359895036534988,-0.371317193951837,-0.382683432365090,-0.393992040061048,-0.405241314004990,-0.416429560097637,-0.427555093430282,-0.438616238538527,-0.449611329654607,-0.460538710958240,-0.471396736825998,-0.482183772079123,-0.492898192229784,-0.503538383725718,-0.514102744193222,-0.524589682678469,-0.534997619887097,-0.545324988422046,-0.555570233019602,-0.565731810783613,-0.575808191417845,-0.585797857456439,-0.595699304492433,-0.605511041404325,-0.615231590580627,-0.624859488142386,-0.634393284163645,-0.643831542889791,-0.653172842953777,-0.662415777590172,-0.671558954847018,-0.680600997795453,-0.689540544737067,-0.698376249408973,-0.707106781186548,-0.715730825283819,-0.724247082951467,-0.732654271672413,-0.740951125354959,-0.749136394523459,-0.757208846506484,-0.765167265622459,-0.773010453362737,-0.780737228572094,-0.788346427626606,-0.795836904608884,-0.803207531480645,-0.810457198252595,-0.817584813151584,-0.824589302785025,-0.831469612302545,-0.838224705554838,-0.844853565249707,-0.851355193105265,-0.857728610000272,-0.863972856121587,-0.870086991108711,-0.876070094195407,-0.881921264348355,-0.887639620402854,-0.893224301195515,-0.898674465693954,-0.903989293123443,-0.909167983090522,-0.914209755703531,-0.919113851690058,-0.923879532511287,-0.928506080473216,-0.932992798834739,-0.937339011912575,-0.941544065183021,-0.945607325380521,-0.949528180593037,-0.953306040354194,-0.956940335732209,-0.960430519415566,-0.963776065795440,-0.966976471044852,-0.970031253194544,-0.972939952205560,-0.975702130038529,-0.978317370719628,-0.980785280403230,-0.983105487431216,-0.985277642388941,-0.987301418157858,-0.989176509964781,-0.990902635427780,-0.992479534598710,-0.993906970002356,-0.995184726672197,-0.996312612182778,-0.997290456678690,-0.998118112900149,-0.998795456205172,-0.999322384588349,-0.999698818696204,-0.999924701839145,-1,-0.999924701839145,-0.999698818696204,-0.999322384588350,-0.998795456205172,-0.998118112900149,-0.997290456678690,-0.996312612182778,-0.995184726672197,-0.993906970002356,-0.992479534598710,-0.990902635427780,-0.989176509964781,-0.987301418157858,-0.985277642388941,-0.983105487431216,-0.980785280403230,-0.978317370719628,-0.975702130038529,-0.972939952205560,-0.970031253194544,-0.966976471044852,-0.963776065795440,-0.960430519415566,-0.956940335732209,-0.953306040354194,-0.949528180593037,-0.945607325380521,-0.941544065183021,-0.937339011912575,-0.932992798834739,-0.928506080473216,-0.923879532511287,-0.919113851690058,-0.914209755703531,-0.909167983090523,-0.903989293123443,-0.898674465693954,-0.893224301195515,-0.887639620402854,-0.881921264348355,-0.876070094195407,-0.870086991108712,-0.863972856121587,-0.857728610000272,-0.851355193105265,-0.844853565249707,-0.838224705554838,-0.831469612302546,-0.824589302785025,-0.817584813151584,-0.810457198252595,-0.803207531480645,-0.795836904608884,-0.788346427626606,-0.780737228572095,-0.773010453362737,-0.765167265622459,-0.757208846506485,-0.749136394523460,-0.740951125354959,-0.732654271672413,-0.724247082951467,-0.715730825283819,-0.707106781186548,-0.698376249408973,-0.689540544737067,-0.680600997795453,-0.671558954847019,-0.662415777590172,-0.653172842953777,-0.643831542889792,-0.634393284163646,-0.624859488142387,-0.615231590580627,-0.605511041404326,-0.595699304492433,-0.585797857456439,-0.575808191417845,-0.565731810783614,-0.555570233019602,-0.545324988422047,-0.534997619887097,-0.524589682678469,-0.514102744193222,-0.503538383725718,-0.492898192229784,-0.482183772079123,-0.471396736825998,-0.460538710958240,-0.449611329654607,-0.438616238538528,-0.427555093430283,-0.416429560097637,-0.405241314004990,-0.393992040061048,-0.382683432365090,-0.371317193951838,-0.359895036534988,-0.348418680249435,-0.336889853392220,-0.325310292162263,-0.313681740398892,-0.302005949319229,-0.290284677254463,-0.278519689385054,-0.266712757474899,-0.254865659604514,-0.242980179903264,-0.231058108280671,-0.219101240156870,-0.207111376192219,-0.195090322016129,-0.183039887955141,-0.170961888760302,-0.158858143333862,-0.146730474455362,-0.134580708507126,-0.122410675199216,-0.110222207293883,-0.0980171403295605,-0.0857973123444403,-0.0735645635996674,-0.0613207363022091,-0.0490676743274181,-0.0368072229413594,-0.0245412285229124,-0.0122715382857206,0.0}; ///< The sine LUT
    const float customWave[lookUpTableSize+1] = {0,0.00002786,0.00022229283,0.00074693292,0.0017595833,0.0034094021,0.0058342137,0.0091579814,0.013488478,0.01891519,0.02550748,0.033313044,0.042356677,0.052639376,0.064137783,0.076803994,0.090565719,0.10532681,0.12096817,0.13734894,0.15430812,0.17166642,0.18922846,0.20678521,0.22411666,0.2409947,0.25718618,0.27245606,0.28657067,0.299301,0.31042596,0.31973567,0.32703454,0.33214433,0.33490694,0.33518706,0.33287449,0.32788627,0.32016836,0.30969709,0.29648019,0.28055742,0.26200085,0.24091467,0.2174346,0.19172695,0.16398719,0.13443819,0.10332802,0.070927511,0.037527365,0.0034350461,-0.031028609,-0.065532995,-0.099741521,-0.13331553,-0.1659183,-0.19721908,-0.22689714,-0.25464569,-0.2801758,-0.30322006,-0.32353607,-0.34090972,-0.35515809,-0.3661321,-0.37371877,-0.37784304,-0.37846922,-0.37560195,-0.36928674,-0.35961,-0.34669859,-0.33071891,-0.31187551,-0.2904092,-0.26659478,-0.2407383,-0.21317393,-0.18426049,-0.15437761,-0.12392165,-0.09330139,-0.06293346,-0.033237711,-0.0046324568,0.022470309,0.047669669,0.070580461,0.09083782,0.10810154,0.1220602,0.13243496,0.13898314,0.14150123,0.13982769,0.13384515,0.12348223,0.10871479,0.089566672,0.066109979,0.038464722,0.0067979846,-0.028677448,-0.067704993,-0.10998666,-0.15518591,-0.20293099,-0.25281864,-0.30441818,-0.35727595,-0.41091999,-0.46486493,-0.51861714,-0.57167987,-0.62355856,-0.67376608,-0.72182789,-0.76728717,-0.8097097,-0.84868851,-0.88384828,-0.9148494,-0.94139159,-0.96321721,-0.980114,-0.99191743,-0.99851242,-0.99983465,-0.9958712,-0.98666076,-0.97229313,-0.95290833,-0.928695,-0.8998884,-0.86676789,-0.82965382,-0.78890416,-0.74491057,-0.69809422,-0.64890123,-0.5977979,-0.54526571,-0.49179616,-0.43788556,-0.38402977,-0.33071891,-0.27843229,-0.22763331,-0.17876473,-0.13224403,-0.088459226,-0.047764892,-0.010478681,0.02312179,0.052801568,0.078370513,0.099684937,0.11664872,0.12921387,0.1373806,0.1411968,0.14075705,0.13620105,0.12771162,0.11551223,0.09986407,0.08106271,0.059434468,0.035332411,0.0091321095,-0.018772818,-0.047975326,-0.078059663,-0.10860615,-0.13919596,-0.1694158,-0.19886256,-0.22714771,-0.25390153,-0.27877707,-0.30145381,-0.32164095,-0.33908038,-0.35354914,-0.36486157,-0.37287089,-0.37747038,-0.37859406,-0.37621688,-0.37035446,-0.36106232,-0.3484347,-0.33260289,-0.31373318,-0.29202444,-0.26770531,-0.24103112,-0.2122805,-0.18175177,-0.14975918,-0.11662898,-0.082695405,-0.048296653,-0.013770842,0.020547947,0.054333531,0.08727132,0.11906182,0.1494239,0.17809778,0.20484767,0.22946418,0.25176621,0.2716026,0.28885329,0.30343011,0.31527716,0.32437073,0.33071891,0.33436071,0.33536481,0.33382805,0.32987345,0.32364804,0.31532032,0.30507757,0.29312291,0.27967224,0.264951,0.24919095,0.23262685,0.2154932,0.19802103,0.18043475,0.16294924,0.14576703,0.12907574,0.11304577,0.097828265,0.083553376,0.070328864,0.058239035,0.047344028,0.037679473,0.029256504,0.022062133,0.016059981,0.011191344,0.007376587,0.0045168329,0.0024959365,0.0011826996,0.0004333041,0.00009392,0.00003484,-0.00003484,-0.00009392,-0.0004333041,-0.0011826996,-0.0024959365,-0.0045168329,-0.007376587,-0.011191344,-0.016059981,-0.022062133,-0.029256504,-0.037679473,-0.047344028,-0.058239035,-0.070328864,-0.083553376,-0.097828265,-0.11304577,-0.12907574,-0.14576703,-0.16294924,-0.18043475,-0.19802103,-0.2154932,-0.23262685,-0.24919095,-0.264951,-0.27967224,-0.29312291,-0.30507757,-0.31532032,-0.32364804,-0.32987345,-0.33382805,-0.33536481,-0.33436071,-0.33071891,-0.32437073,-0.31527716,-0.30343011,-0.28885329,-0.2716026,-0.25176621,-0.22946418,-0.20484767,-0.17809778,-0.1494239,-0.11906182,-0.08727132,-0.054333531,-0.020547947,0.013770842,0.048296653,0.082695405,0.11662898,0.14975918,0.18175177,0.2122805,0.24103112,0.26770531,0.29202444,0.31373318,0.33260289,0.3484347,0.36106232,0.37035446,0.37621688,0.37859406,0.37747038,0.37287089,0.36486157,0.35354914,0.33908038,0.32164095,0.30145381,0.27877707,0.25390153,0.22714771,0.19886256,0.1694158,0.13919596,0.10860615,0.078059663,0.047975326,0.018772818,-0.0091321095,-0.035332411,-0.059434468,-0.08106271,-0.09986407,-0.11551223,-0.12771162,-0.13620105,-0.14075705,-0.1411968,-0.1373806,-0.12921387,-0.11664872,-0.099684937,-0.078370513,-0.052801568,-0.02312179,0.010478681,0.047764892,0.088459226,0.13224403,0.17876473,0.22763331,0.27843229,0.33071891,0.38402977,0.43788556,0.49179616,0.54526571,0.5977979,0.64890123,0.69809422,0.74491057,0.78890416,0.82965382,0.86676789,0.8998884,0.928695,0.95290833,0.97229313,0.98666076,0.9958712,0.99983465,0.99851242,0.99191743,0.980114,0.96321721,0.94139159,0.9148494,0.88384828,0.84868851,0.8097097,0.76728717,0.72182789,0.67376608,0.62355856,0.57167987,0.51861714,0.46486493,0.41091999,0.35727595,0.30441818,0.25281864,0.20293099,0.15518591,0.10998666,0.067704993,0.028677448,-0.0067979846,-0.038464722,-0.066109979,-0.089566672,-0.10871479,-0.12348223,-0.13384515,-0.13982769,-0.14150123,-0.13898314,-0.13243496,-0.1220602,-0.10810154,-0.09083782,-0.070580461,-0.047669669,-0.022470309,0.0046324568,0.033237711,0.06293346,0.09330139,0.12392165,0.15437761,0.18426049,0.21317393,0.2407383,0.26659478,0.2904092,0.31187551,0.33071891,0.34669859,0.35961,0.36928674,0.37560195,0.37846922,0.37784304,0.37371877,0.3661321,0.35515809,0.34090972,0.32353607,0.30322006,0.2801758,0.25464569,0.22689714,0.19721908,0.1659183,0.13331553,0.099741521,0.065532995,0.031028609,-0.0034350461,-0.037527365,-0.070927511,-0.10332802,-0.13443819,-0.16398719,-0.19172695,-0.2174346,-0.24091467,-0.26200085,-0.28055742,-0.29648019,-0.30969709,-0.32016836,-0.32788627,-0.33287449,-0.33518706,-0.33490694,-0.33214433,-0.32703454,-0.31973567,-0.31042596,-0.299301,-0.28657067,-0.27245606,-0.25718618,-0.2409947,-0.22411666,-0.20678521,-0.18922846,-0.17166642,-0.15430812,-0.13734894,-0.12096817,-0.10532681,-0.090565719,-0.076803994,-0.064137783,-0.052639376,-0.042356677,-0.033313044,-0.02550748,-0.01891519,-0.013488478,-0.0091579814,-0.0058342137,-0.0034094021,-0.0017595833,-0.00074693292,-0.00022229283,-0.00002786,-0.00001786,0}; ///< The custom-wave LUT
    const float saw[lookUpTableSize+1] = {-1,-0.996093750000000,-0.992187500000000,-0.988281250000000,-0.984375000000000,-0.980468750000000,-0.976562500000000,-0.972656250000000,-0.968750000000000,-0.964843750000000,-0.960937500000000,-0.957031250000000,-0.953125000000000,-0.949218750000000,-0.945312500000000,-0.941406250000000,-0.937500000000000,-0.933593750000000,-0.929687500000000,-0.925781250000000,-0.921875000000000,-0.917968750000000,-0.914062500000000,-0.910156250000000,-0.906250000000000,-0.902343750000000,-0.898437500000000,-0.894531250000000,-0.890625000000000,-0.886718750000000,-0.882812500000000,-0.878906250000000,-0.875000000000000,-0.871093750000000,-0.867187500000000,-0.863281250000000,-0.859375000000000,-0.855468750000000,-0.851562500000000,-0.847656250000000,-0.843750000000000,-0.839843750000000,-0.835937500000000,-0.832031250000000,-0.828125000000000,-0.824218750000000,-0.820312500000000,-0.816406250000000,-0.812500000000000,-0.808593750000000,-0.804687500000000,-0.800781250000000,-0.796875000000000,-0.792968750000000,-0.789062500000000,-0.785156250000000,-0.781250000000000,-0.777343750000000,-0.773437500000000,-0.769531250000000,-0.765625000000000,-0.761718750000000,-0.757812500000000,-0.753906250000000,-0.750000000000000,-0.746093750000000,-0.742187500000000,-0.738281250000000,-0.734375000000000,-0.730468750000000,-0.726562500000000,-0.722656250000000,-0.718750000000000,-0.714843750000000,-0.710937500000000,-0.707031250000000,-0.703125000000000,-0.699218750000000,-0.695312500000000,-0.691406250000000,-0.687500000000000,-0.683593750000000,-0.679687500000000,-0.675781250000000,-0.671875000000000,-0.667968750000000,-0.664062500000000,-0.660156250000000,-0.656250000000000,-0.652343750000000,-0.648437500000000,-0.644531250000000,-0.640625000000000,-0.636718750000000,-0.632812500000000,-0.628906250000000,-0.625000000000000,-0.621093750000000,-0.617187500000000,-0.613281250000000,-0.609375000000000,-0.605468750000000,-0.601562500000000,-0.597656250000000,-0.593750000000000,-0.589843750000000,-0.585937500000000,-0.582031250000000,-0.578125000000000,-0.574218750000000,-0.570312500000000,-0.566406250000000,-0.562500000000000,-0.558593750000000,-0.554687500000000,-0.550781250000000,-0.546875000000000,-0.542968750000000,-0.539062500000000,-0.535156250000000,-0.531250000000000,-0.527343750000000,-0.523437500000000,-0.519531250000000,-0.515625000000000,-0.511718750000000,-0.507812500000000,-0.503906250000000,-0.500000000000000,-0.496093750000000,-0.492187500000000,-0.488281250000000,-0.484375000000000,-0.480468750000000,-0.476562500000000,-0.472656250000000,-0.468750000000000,-0.464843750000000,-0.460937500000000,-0.457031250000000,-0.453125000000000,-0.449218750000000,-0.445312500000000,-0.441406250000000,-0.437500000000000,-0.433593750000000,-0.429687500000000,-0.425781250000000,-0.421875000000000,-0.417968750000000,-0.414062500000000,-0.410156250000000,-0.406250000000000,-0.402343750000000,-0.398437500000000,-0.394531250000000,-0.390625000000000,-0.386718750000000,-0.382812500000000,-0.378906250000000,-0.375000000000000,-0.371093750000000,-0.367187500000000,-0.363281250000000,-0.359375000000000,-0.355468750000000,-0.351562500000000,-0.347656250000000,-0.343750000000000,-0.339843750000000,-0.335937500000000,-0.332031250000000,-0.328125000000000,-0.324218750000000,-0.320312500000000,-0.316406250000000,-0.312500000000000,-0.308593750000000,-0.304687500000000,-0.300781250000000,-0.296875000000000,-0.292968750000000,-0.289062500000000,-0.285156250000000,-0.281250000000000,-0.277343750000000,-0.273437500000000,-0.269531250000000,-0.265625000000000,-0.261718750000000,-0.257812500000000,-0.253906250000000,-0.250000000000000,-0.246093750000000,-0.242187500000000,-0.238281250000000,-0.234375000000000,-0.230468750000000,-0.226562500000000,-0.222656250000000,-0.218750000000000,-0.214843750000000,-0.210937500000000,-0.207031250000000,-0.203125000000000,-0.199218750000000,-0.195312500000000,-0.191406250000000,-0.187500000000000,-0.183593750000000,-0.179687500000000,-0.175781250000000,-0.171875000000000,-0.167968750000000,-0.164062500000000,-0.160156250000000,-0.156250000000000,-0.152343750000000,-0.148437500000000,-0.144531250000000,-0.140625000000000,-0.136718750000000,-0.132812500000000,-0.128906250000000,-0.125000000000000,-0.121093750000000,-0.117187500000000,-0.113281250000000,-0.109375000000000,-0.105468750000000,-0.101562500000000,-0.0976562499999999,-0.0937499999999999,-0.0898437500000000,-0.0859375000000000,-0.0820312500000000,-0.0781250000000000,-0.0742187500000000,-0.0703125000000000,-0.0664062500000000,-0.0625000000000000,-0.0585937499999999,-0.0546874999999999,-0.0507812500000000,-0.0468750000000000,-0.0429687500000000,-0.0390625000000000,-0.0351562500000000,-0.0312500000000000,-0.0273437500000000,-0.0234375000000000,-0.0195312499999999,-0.0156249999999999,-0.0117187499999999,-0.00781250000000000,-0.00390625000000000,0,0.00390625000000000,0.00781250000000000,0.0117187500000000,0.0156250000000000,0.0195312500000000,0.0234375000000000,0.0273437500000000,0.0312500000000000,0.0351562500000000,0.0390625000000000,0.0429687500000000,0.0468750000000000,0.0507812500000000,0.0546875000000000,0.0585937500000000,0.0625000000000000,0.0664062500000000,0.0703125000000000,0.0742187500000000,0.0781250000000000,0.0820312500000000,0.0859375000000000,0.0898437500000000,0.0937500000000000,0.0976562500000000,0.101562500000000,0.105468750000000,0.109375000000000,0.113281250000000,0.117187500000000,0.121093750000000,0.125000000000000,0.128906250000000,0.132812500000000,0.136718750000000,0.140625000000000,0.144531250000000,0.148437500000000,0.152343750000000,0.156250000000000,0.160156250000000,0.164062500000000,0.167968750000000,0.171875000000000,0.175781250000000,0.179687500000000,0.183593750000000,0.187500000000000,0.191406250000000,0.195312500000000,0.199218750000000,0.203125000000000,0.207031250000000,0.210937500000000,0.214843750000000,0.218750000000000,0.222656250000000,0.226562500000000,0.230468750000000,0.234375000000000,0.238281250000000,0.242187500000000,0.246093750000000,0.250000000000000,0.253906250000000,0.257812500000000,0.261718750000000,0.265625000000000,0.269531250000000,0.273437500000000,0.277343750000000,0.281250000000000,0.285156250000000,0.289062500000000,0.292968750000000,0.296875000000000,0.300781250000000,0.304687500000000,0.308593750000000,0.312500000000000,0.316406250000000,0.320312500000000,0.324218750000000,0.328125000000000,0.332031250000000,0.335937500000000,0.339843750000000,0.343750000000000,0.347656250000000,0.351562500000000,0.355468750000000,0.359375000000000,0.363281250000000,0.367187500000000,0.371093750000000,0.375000000000000,0.378906250000000,0.382812500000000,0.386718750000000,0.390625000000000,0.394531250000000,0.398437500000000,0.402343750000000,0.406250000000000,0.410156250000000,0.414062500000000,0.417968750000000,0.421875000000000,0.425781250000000,0.429687500000000,0.433593750000000,0.437500000000000,0.441406250000000,0.445312500000000,0.449218750000000,0.453125000000000,0.457031250000000,0.460937500000000,0.464843750000000,0.468750000000000,0.472656250000000,0.476562500000000,0.480468750000000,0.484375000000000,0.488281250000000,0.492187500000000,0.496093750000000,0.500000000000000,0.503906250000000,0.507812500000000,0.511718750000000,0.515625000000000,0.519531250000000,0.523437500000000,0.527343750000000,0.531250000000000,0.535156250000000,0.539062500000000,0.542968750000000,0.546875000000000,0.550781250000000,0.554687500000000,0.558593750000000,0.562500000000000,0.566406250000000,0.570312500000000,0.574218750000000,0.578125000000000,0.582031250000000,0.585937500000000,0.589843750000000,0.593750000000000,0.597656250000000,0.601562500000000,0.605468750000000,0.609375000000000,0.613281250000000,0.617187500000000,0.621093750000000,0.625000000000000,0.628906250000000,0.632812500000000,0.636718750000000,0.640625000000000,0.644531250000000,0.648437500000000,0.652343750000000,0.656250000000000,0.660156250000000,0.664062500000000,0.667968750000000,0.671875000000000,0.675781250000000,0.679687500000000,0.683593750000000,0.687500000000000,0.691406250000000,0.695312500000000,0.699218750000000,0.703125000000000,0.707031250000000,0.710937500000000,0.714843750000000,0.718750000000000,0.722656250000000,0.726562500000000,0.730468750000000,0.734375000000000,0.738281250000000,0.742187500000000,0.746093750000000,0.750000000000000,0.753906250000000,0.757812500000000,0.761718750000000,0.765625000000000,0.769531250000000,0.773437500000000,0.777343750000000,0.781250000000000,0.785156250000000,0.789062500000000,0.792968750000000,0.796875000000000,0.800781250000000,0.804687500000000,0.808593750000000,0.812500000000000,0.816406250000000,0.820312500000000,0.824218750000000,0.828125000000000,0.832031250000000,0.835937500000000,0.839843750000000,0.843750000000000,0.847656250000000,0.851562500000000,0.855468750000000,0.859375000000000,0.863281250000000,0.867187500000000,0.871093750000000,0.875000000000000,0.878906250000000,0.882812500000000,0.886718750000000,0.890625000000000,0.894531250000000,0.898437500000000,0.902343750000000,0.906250000000000,0.910156250000000,0.914062500000000,0.917968750000000,0.921875000000000,0.925781250000000,0.929687500000000,0.933593750000000,0.937500000000000,0.941406250000000,0.945312500000000,0.949218750000000,0.953125000000000,0.957031250000000,0.960937500000000,0.964843750000000,0.968750000000000,0.972656250000000,0.976562500000000,0.980468750000000,0.984375000000000,0.988281250000000,0.992187500000000,0.996093750000000,-1}; ///< The sawtooth LUT
    const float tri[lookUpTableSize+1] = {-1,-0.992187500000000,-0.984375000000000,-0.976562500000000,-0.968750000000000,-0.960937500000000,-0.953125000000000,-0.945312500000000,-0.937500000000000,-0.929687500000000,-0.921875000000000,-0.914062500000000,-0.906250000000000,-0.898437500000000,-0.890625000000000,-0.882812500000000,-0.875000000000000,-0.867187500000000,-0.859375000000000,-0.851562500000000,-0.843750000000000,-0.835937500000000,-0.828125000000000,-0.820312500000000,-0.812500000000000,-0.804687500000000,-0.796875000000000,-0.789062500000000,-0.781250000000000,-0.773437500000000,-0.765625000000000,-0.757812500000000,-0.750000000000000,-0.742187500000000,-0.734375000000000,-0.726562500000000,-0.718750000000000,-0.710937500000000,-0.703125000000000,-0.695312500000000,-0.687500000000000,-0.679687500000000,-0.671875000000000,-0.664062500000000,-0.656250000000000,-0.648437500000000,-0.640625000000000,-0.632812500000000,-0.625000000000000,-0.617187500000000,-0.609375000000000,-0.601562500000000,-0.593750000000000,-0.585937500000000,-0.578125000000000,-0.570312500000000,-0.562500000000000,-0.554687500000000,-0.546875000000000,-0.539062500000000,-0.531250000000000,-0.523437500000000,-0.515625000000000,-0.507812500000000,-0.500000000000000,-0.492187500000000,-0.484375000000000,-0.476562500000000,-0.468750000000000,-0.460937500000000,-0.453125000000000,-0.445312500000000,-0.437500000000000,-0.429687500000000,-0.421875000000000,-0.414062500000000,-0.406250000000000,-0.398437500000000,-0.390625000000000,-0.382812500000000,-0.375000000000000,-0.367187500000000,-0.359375000000000,-0.351562500000000,-0.343750000000000,-0.335937500000000,-0.328125000000000,-0.320312500000000,-0.312500000000000,-0.304687500000000,-0.296875000000000,-0.289062500000000,-0.281250000000000,-0.273437500000000,-0.265625000000000,-0.257812500000000,-0.250000000000000,-0.242187500000000,-0.234375000000000,-0.226562500000000,-0.218750000000000,-0.210937500000000,-0.203125000000000,-0.195312500000000,-0.187500000000000,-0.179687500000000,-0.171875000000000,-0.164062500000000,-0.156250000000000,-0.148437500000000,-0.140625000000000,-0.132812500000000,-0.125000000000000,-0.117187500000000,-0.109375000000000,-0.101562500000000,-0.0937499999999999,-0.0859375000000000,-0.0781250000000000,-0.0703125000000000,-0.0625000000000000,-0.0546874999999999,-0.0468750000000000,-0.0390625000000000,-0.0312500000000000,-0.0234375000000000,-0.0156249999999999,-0.00781250000000000,0,0.00781250000000000,0.0156250000000000,0.0234375000000000,0.0312500000000000,0.0390625000000000,0.0468750000000000,0.0546875000000000,0.0625000000000000,0.0703125000000000,0.0781250000000000,0.0859375000000000,0.0937500000000000,0.101562500000000,0.109375000000000,0.117187500000000,0.125000000000000,0.132812500000000,0.140625000000000,0.148437500000000,0.156250000000000,0.164062500000000,0.171875000000000,0.179687500000000,0.187500000000000,0.195312500000000,0.203125000000000,0.210937500000000,0.218750000000000,0.226562500000000,0.234375000000000,0.242187500000000,0.250000000000000,0.257812500000000,0.265625000000000,0.273437500000000,0.281250000000000,0.289062500000000,0.296875000000000,0.304687500000000,0.312500000000000,0.320312500000000,0.328125000000000,0.335937500000000,0.343750000000000,0.351562500000000,0.359375000000000,0.367187500000000,0.375000000000000,0.382812500000000,0.390625000000000,0.398437500000000,0.406250000000000,0.414062500000000,0.421875000000000,0.429687500000000,0.437500000000000,0.445312500000000,0.453125000000000,0.460937500000000,0.468750000000000,0.476562500000000,0.484375000000000,0.492187500000000,0.500000000000000,0.507812500000000,0.515625000000000,0.523437500000000,0.531250000000000,0.539062500000000,0.546875000000000,0.554687500000000,0.562500000000000,0.570312500000000,0.578125000000000,0.585937500000000,0.593750000000000,0.601562500000000,0.609375000000000,0.617187500000000,0.625000000000000,0.632812500000000,0.640625000000000,0.648437500000000,0.656250000000000,0.664062500000000,0.671875000000000,0.679687500000000,0.687500000000000,0.695312500000000,0.703125000000000,0.710937500000000,0.718750000000000,0.726562500000000,0.734375000000000,0.742187500000000,0.750000000000000,0.757812500000000,0.765625000000000,0.773437500000000,0.781250000000000,0.789062500000000,0.796875000000000,0.804687500000000,0.812500000000000,0.820312500000000,0.828125000000000,0.835937500000000,0.843750000000000,0.851562500000000,0.859375000000000,0.867187500000000,0.875000000000000,0.882812500000000,0.890625000000000,0.898437500000000,0.906250000000000,0.914062500000000,0.921875000000000,0.929687500000000,0.937500000000000,0.945312500000000,0.953125000000000,0.960937500000000,0.968750000000000,0.976562500000000,0.984375000000000,0.992187500000000,1,0.992187500000000,0.984375000000000,0.976562500000000,0.968750000000000,0.960937500000000,0.953125000000000,0.945312500000000,0.937500000000000,0.929687500000000,0.921875000000000,0.914062500000000,0.906250000000000,0.898437500000000,0.890625000000000,0.882812500000000,0.875000000000000,0.867187500000000,0.859375000000000,0.851562500000000,0.843750000000000,0.835937500000000,0.828125000000000,0.820312500000000,0.812500000000000,0.804687500000000,0.796875000000000,0.789062500000000,0.781250000000000,0.773437500000000,0.765625000000000,0.757812500000000,0.750000000000000,0.742187500000000,0.734375000000000,0.726562500000000,0.718750000000000,0.710937500000000,0.703125000000000,0.695312500000000,0.687500000000000,0.679687500000000,0.671875000000000,0.664062500000000,0.656250000000000,0.648437500000000,0.640625000000000,0.632812500000000,0.625000000000000,0.617187500000000,0.609375000000000,0.601562500000000,0.593750000000000,0.585937500000000,0.578125000000000,0.570312500000000,0.562500000000000,0.554687500000000,0.546875000000000,0.539062500000000,0.531250000000000,0.523437500000000,0.515625000000000,0.507812500000000,0.500000000000000,0.492187500000000,0.484375000000000,0.476562500000000,0.468750000000000,0.460937500000000,0.453125000000000,0.445312500000000,0.437500000000000,0.429687500000000,0.421875000000000,0.414062500000000,0.406250000000000,0.398437500000000,0.390625000000000,0.382812500000000,0.375000000000000,0.367187500000000,0.359375000000000,0.351562500000000,0.343750000000000,0.335937500000000,0.328125000000000,0.320312500000000,0.312500000000000,0.304687500000000,0.296875000000000,0.289062500000000,0.281250000000000,0.273437500000000,0.265625000000000,0.257812500000000,0.250000000000000,0.242187500000000,0.234375000000000,0.226562500000000,0.218750000000000,0.210937500000000,0.203125000000000,0.195312500000000,0.187500000000000,0.179687500000000,0.171875000000000,0.164062500000000,0.156250000000000,0.148437500000000,0.140625000000000,0.132812500000000,0.125000000000000,0.117187500000000,0.109375000000000,0.101562500000000,0.0937500000000000,0.0859375000000000,0.0781249999999996,0.0703125000000000,0.0624999999999996,0.0546875000000000,0.0468749999999996,0.0390625000000000,0.0312500000000000,0.0234375000000000,0.0156250000000000,0.00781250000000000,0,-0.00781250000000044,-0.0156250000000000,-0.0234375000000004,-0.0312500000000000,-0.0390625000000000,-0.0468750000000000,-0.0546875000000000,-0.0625000000000000,-0.0703125000000000,-0.0781250000000000,-0.0859375000000000,-0.0937500000000004,-0.101562500000000,-0.109375000000000,-0.117187500000000,-0.125000000000000,-0.132812500000000,-0.140625000000000,-0.148437500000000,-0.156250000000000,-0.164062500000000,-0.171875000000000,-0.179687500000000,-0.187500000000000,-0.195312500000000,-0.203125000000000,-0.210937500000000,-0.218750000000000,-0.226562500000000,-0.234375000000000,-0.242187500000000,-0.250000000000000,-0.257812500000000,-0.265625000000000,-0.273437500000000,-0.281250000000000,-0.289062500000000,-0.296875000000000,-0.304687500000000,-0.312500000000000,-0.320312500000000,-0.328125000000000,-0.335937500000000,-0.343750000000000,-0.351562500000000,-0.359375000000000,-0.367187500000000,-0.375000000000000,-0.382812500000000,-0.390625000000000,-0.398437500000000,-0.406250000000000,-0.414062500000000,-0.421875000000000,-0.429687500000000,-0.437500000000000,-0.445312500000000,-0.453125000000000,-0.460937500000000,-0.468750000000000,-0.476562500000000,-0.484375000000000,-0.492187500000000,-0.500000000000000,-0.507812500000000,-0.515625000000000,-0.523437500000000,-0.531250000000000,-0.539062500000000,-0.546875000000000,-0.554687500000000,-0.562500000000000,-0.570312500000000,-0.578125000000000,-0.585937500000000,-0.593750000000000,-0.601562500000000,-0.609375000000000,-0.617187500000000,-0.625000000000000,-0.632812500000000,-0.640625000000000,-0.648437500000000,-0.656250000000000,-0.664062500000000,-0.671875000000000,-0.679687500000000,-0.687500000000000,-0.695312500000000,-0.703125000000000,-0.710937500000000,-0.718750000000000,-0.726562500000000,-0.734375000000000,-0.742187500000000,-0.750000000000000,-0.757812500000000,-0.765625000000000,-0.773437500000000,-0.781250000000000,-0.789062500000000,-0.796875000000000,-0.804687500000000,-0.812500000000000,-0.820312500000000,-0.828125000000000,-0.835937500000000,-0.843750000000000,-0.851562500000000,-0.859375000000000,-0.867187500000000,-0.875000000000000,-0.882812500000000,-0.890625000000000,-0.898437500000000,-0.906250000000000,-0.914062500000000,-0.921875000000000,-0.929687500000000,-0.937500000000000,-0.945312500000000,-0.953125000000000,-0.960937500000000,-0.968750000000000,-0.976562500000000,-0.984375000000000,-0.992187500000000,-1}; ///< The triangle LUT
};

